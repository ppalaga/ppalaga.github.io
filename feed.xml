<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://peter.palaga.org/feed.xml" rel="self" type="application/atom+xml" /><link href="https://peter.palaga.org/" rel="alternate" type="text/html" /><updated>2021-12-31T16:08:30+00:00</updated><id>https://peter.palaga.org/feed.xml</id><title type="html">Peter Palaga</title><subtitle>A software engineer at Red Hat Integration, working mostly on Apache Camel Quarkus, coauthor of mvnd, srcdeps and ec4j.</subtitle><entry><title type="html">Lego 51515 on Fedora</title><link href="https://peter.palaga.org/2021/12/28/lego-51515-on-fedora.html" rel="alternate" type="text/html" title="Lego 51515 on Fedora" /><published>2021-12-28T00:00:00+00:00</published><updated>2021-12-28T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/12/28/lego-51515-on-fedora</id><content type="html" xml:base="https://peter.palaga.org/2021/12/28/lego-51515-on-fedora.html">&lt;h1&gt;Lego 51515 on Fedora&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;My 13 years old son VÃ­tek just got &lt;a href=&quot;https://www.lego.com/en-us/product/robot-inventor-51515&quot;&gt;LEGO 51515 (a.k.a. Robot Inventor)&lt;/a&gt; for Christmas.
He assessed the Scratch programming in the Android app as &quot;limiting&quot; after playing with it for a couple of hours and he uttered a wish to try Python.
Unfortunately, Lego does not provide any tools for Linux, the the main OS used within our family.
So we started to look for workarounds.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;All steps mentioned here were done on Fedora 34.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First we tried &lt;a href=&quot;https://github.com/smr99/lego-hub-tk&quot;&gt;LEGO Hub Toolkit&lt;/a&gt; by Steven M. Robbins which worked for us only through USB but not via Bluetooth.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Peter Staev&amp;#8217;s &lt;a href=&quot;https://github.com/PeterStaev/lego-spikeprime-mindstorms-vscode&quot;&gt;LEGO SPIKE Prime / MINDSTORMS Robot Inventor VS Code Extension&lt;/a&gt; offered the best experience so far.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;how_to_install_lego_spike_prime_mindstorms_robot_inventor_vs_code_extension&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#how_to_install_lego_spike_prime_mindstorms_robot_inventor_vs_code_extension&quot;&gt;&lt;/a&gt;How to install LEGO SPIKE Prime / MINDSTORMS Robot Inventor VS Code Extension&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Of course you need VS Code first.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;install_vs_code&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#install_vs_code&quot;&gt;&lt;/a&gt;Install VS Code&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want the newest version, getting the 64 bit &lt;code&gt;.tar.gz&lt;/code&gt; flavor from &lt;a href=&quot;https://code.visualstudio.com/download#&quot;&gt;VS Code downloads page&lt;/a&gt; might be the safest choice.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Unpack it, once you have downloaded it to &lt;code&gt;~/Downloads&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ cd ~/bin
$ tar xfz ~/Downloads/code-stable-x64-*.tar.gz&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Add the &lt;code&gt;code&lt;/code&gt; executable to &lt;code&gt;PATH&lt;/code&gt; environment variable so that you can open any folder using &lt;code&gt;code .&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Open the &lt;code&gt;~/.bashrc&lt;/code&gt; file with &lt;code&gt;kwrite&lt;/code&gt; or any other text editor&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ kwrite ~/.bashrc&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;and add the following line somewhere around the beginning of the file&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;export PATH=&amp;quot;$HOME/bin/VSCode-linux-x64/bin:$PATH&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Save and close the &lt;code&gt;~/.bashrc&lt;/code&gt; file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then create a new directory for your Python experiments and open VS Code in that directory:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ mkdir -p ~/code/python
$ cd ~/code/python
$ code .&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;install_the_lego_spike_prime_mindstorms_robot_inventor_extension&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#install_the_lego_spike_prime_mindstorms_robot_inventor_extension&quot;&gt;&lt;/a&gt;Install the LEGO SPIKE Prime / MINDSTORMS Robot Inventor Extension&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In VS Code, open the Extensions view by hitting &lt;code&gt;CTRL+SHIFT+x&lt;/code&gt;.
Then type &lt;code&gt;lego spike&lt;/code&gt; in the search field, select the found &lt;code&gt;LEGO SPIKE Prime / MINDSTORMS Robot Inventor Extension&lt;/code&gt;
and click the blue &lt;code&gt;Install&lt;/code&gt; button to install it.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;connect_via_usb&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#connect_via_usb&quot;&gt;&lt;/a&gt;Connect via USB&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First let&amp;#8217;s try connecting via USB.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For this to work on my Fedora 34, I had to add the current user to dialout group.
Otherwise I was getting the &lt;code&gt;Permission denied: '/dev/ttyACM0'&lt;/code&gt; error when connecting.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ sudo usermod -aG dialout $USER&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You&amp;#8217;ll possibly need to restart VS Code or even re-login for the new group membership to get effective.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then you can connect the USB cable - one end to the Lego HUB and the other end to your computer.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At the bottom of the VS Code window, click the blue &lt;code&gt;LEGO Hub: Disconnected&lt;/code&gt; area&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/lego-hub-disconnected.png&quot; alt=&quot;LEGO Hub: Disconnected&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This should let you select the device you want to connect:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/select-device.png&quot; alt=&quot;Select device&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Select &lt;code&gt;/dev/ttyACM0&lt;/code&gt; for USB.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once the connection succeeds, a couple of new buttons should appear at the top of the VS Code window:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/extension-buttons.png&quot; alt=&quot;Lego Hub Extension buttons&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;These allow you to&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Start an already uploaded program&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Stop the currently running program&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Upload the current file (in VS Code) to the Hub&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Show the Hub&amp;#8217;s terminal where you can i.a. see the error messages if something goes wrong with your little program&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;hello_world&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#hello_world&quot;&gt;&lt;/a&gt;Hello world!&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Let&amp;#8217;s try to write some simple program to make sure that the connection really works.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Create a new file named &lt;code&gt;test.py&lt;/code&gt; in the &lt;code&gt;~/code/python&lt;/code&gt; folder and paste the following into the editor:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;python&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# LEGO type:standard slot:5 autostart&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;include&quot;&gt;hub&lt;/span&gt;
hub.sound.beep(&lt;span class=&quot;integer&quot;&gt;800&lt;/span&gt;, &lt;span class=&quot;integer&quot;&gt;2000&lt;/span&gt;, &lt;span class=&quot;integer&quot;&gt;0&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first line is specific to the extension and its meaning is documented in the &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=PeterStaev.lego-spikeprime-mindstorms-vscode#automatic-uploadstart-of-a-python-file&quot;&gt;extension&amp;#8217;s README&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once you have saved the file, you can hit the â­® button to upload and autostart it to the hub.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You should hear a two seconds beep if everything works correctly.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;bluetooth&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#bluetooth&quot;&gt;&lt;/a&gt;Bluetooth&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To test the Bluetooth connection, first disconnect the USB by clicking the blue &lt;code&gt;LEGO Hub: Connected&lt;/code&gt; area at the bottom of the VS Code window. Then unplug the USB cable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Make sure Bluetooth is on on your PC e.g. by clicking the Blueman applet icon in the system tray.
If it shows an option &quot;Turn Bluetooth Off&quot;, then your Bluetooth is apparently on :-)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/blueman-bt-on.png&quot; alt=&quot;Bluetooth is on&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then pair the hub:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Click the Blueman applet icon in the system tray and click &quot;Devices&quot;&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/blueman-applet-devices.png&quot; alt=&quot;Blueman &amp;#8594; Devices&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Make sure the Lego Hub is on and press the Bluetooth button on the Hub.
The Bluetooth button on the Hub should start flashing blue and you should hear some beeping.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Then start scanning for BT devices by pressing &quot;Search&quot; in the Blueman Devices window&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/blueman-devices-search.png&quot; alt=&quot;Blueman Devices &amp;#8594; Search&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;After a while a device named &quot;LEGO Hub &amp;lt;Mac address&amp;gt;&quot; should appear in the list of devices:&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/lego-hub-found.png&quot; alt=&quot;Lego hub found&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Open its context menu by right-clicking it and click &quot;Pair&quot;&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/bt-pair-device.png&quot; alt=&quot;Pair the device&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;initial_serial_connection&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#initial_serial_connection&quot;&gt;&lt;/a&gt;Initial serial connection&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once the device is paired, create a an initial serial connection with the device using Blueman that we will disconnect right away.
I am not quite sure why this is necessary.
I guess it creates the &lt;code&gt;/dev/rfcomm0&lt;/code&gt; device that persists after disconnecting and which the VS Code extension is not able to do itself for some reason.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Right-click the Hub in Devices window and click &quot;Connect to: Serial Port&quot;&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/bt-serial-port.png&quot; alt=&quot;Connect to serial port&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Once the connection succeeds the Bluetooth button on the Hub should stop flashing and should start shining blue without interruptions.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Make sure the the &lt;code&gt;rfcomm&lt;/code&gt; device was created:&lt;/p&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ ps -Af | grep /dev/rfcom
ppalaga     4852    3657  0 14:27 ?        00:00:00 /usr/bin/python3 /usr/libexec/blueman-rfcomm-watcher /dev/rfcomm0&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Note the index of the device - it is &lt;code&gt;rfcomm0&lt;/code&gt; in our case, but it could be &lt;code&gt;rfcomm1&lt;/code&gt; or something else in your case.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Disconnect the serial port via Blueman applet menu:&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/disconnect-serial-port.png&quot; alt=&quot;Disconnect the serial connection&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;These initial serial connection steps need to be performed after every restart of the computer.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;connect_via_bluetooth_from_vs_code&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#connect_via_bluetooth_from_vs_code&quot;&gt;&lt;/a&gt;Connect via Bluetooth from VS Code&lt;/h4&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Get back to VS Code and click the blue &lt;code&gt;LEGO Hub: Disconnected&lt;/code&gt; area&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/lego-hub-disconnected.png&quot; alt=&quot;LEGO Hub: Disconnected&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;This should let you select the device to connect to.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If you are lucky, you see &lt;code&gt;/dev/rfcomm0&lt;/code&gt; with the exact index returned by &lt;code&gt;ps -Af | grep /dev/rfcomm&lt;/code&gt; above.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If your device is not there in the list, just type it manually.&lt;/p&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2022/2021-12-28-lego-51515-on-fedora/select-rfcomm0.png&quot; alt=&quot;Select /dev/rfcomm0&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;After that, the connection should succeed and the Bluetooth button on the Hub should start shining blue.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;upload_and_run_a_test_program&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#upload_and_run_a_test_program&quot;&gt;&lt;/a&gt;Upload and run a test program&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To test, whether it works, you can do some change in the &lt;code&gt;test.py&lt;/code&gt; program, e.g. prolong the duration of the beep from &lt;code&gt;2000&lt;/code&gt; to &lt;code&gt;5000&lt;/code&gt; milliseconds:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;python&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# LEGO type:standard slot:5 autostart&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;include&quot;&gt;hub&lt;/span&gt;
hub.sound.beep(&lt;span class=&quot;integer&quot;&gt;800&lt;/span&gt;, &lt;span class=&quot;integer&quot;&gt;5000&lt;/span&gt;, &lt;span class=&quot;integer&quot;&gt;0&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After saving the file, you can hit the â­® button to upload and autostart it to the Hub.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You should hear a five seconds beep if everything works correctly.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That&amp;#8217;s it for making the Hub work on Fedora. I hope I was able to save you some time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am looking forward to your feedback via &lt;a href=&quot;https://twitter.com/ppalaga&quot;&gt;Twitter&lt;/a&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;further_reading&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#further_reading&quot;&gt;&lt;/a&gt;Further reading&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For the actual programming you may find the following resources helpful:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;LEGO Hub Python programming API:&lt;/p&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://lego.github.io/MINDSTORMS-Robot-Inventor-hub-API/&quot; class=&quot;bare&quot;&gt;https://lego.github.io/MINDSTORMS-Robot-Inventor-hub-API/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/sanjayseshan/spikeprime-vscode/wiki/Hub-Programming-API&quot; class=&quot;bare&quot;&gt;https://github.com/sanjayseshan/spikeprime-vscode/wiki/Hub-Programming-API&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://antonsmindstorms.com/2021/01/14/advanced-undocumented-python-in-spike-prime-and-mindstorms-hubs/&quot; class=&quot;bare&quot;&gt;https://antonsmindstorms.com/2021/01/14/advanced-undocumented-python-in-spike-prime-and-mindstorms-hubs/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;FAQ and sample projects: &lt;a href=&quot;https://github.com/maarten-pennings/Lego-Mindstorms/tree/main/ms4&quot; class=&quot;bare&quot;&gt;https://github.com/maarten-pennings/Lego-Mindstorms/tree/main/ms4&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="lego" /><category term="mindstorms" /><category term="51515" /><category term="python" /><summary type="html">Lego 51515 on Fedora My 13 years old son VÃ­tek just got LEGO 51515 (a.k.a. Robot Inventor) for Christmas. He assessed the Scratch programming in the Android app as &quot;limiting&quot; after playing with it for a couple of hours and he uttered a wish to try Python. Unfortunately, Lego does not provide any tools for Linux, the the main OS used within our family. So we started to look for workarounds.</summary></entry><entry><title type="html">My talks on JavaLand 2021</title><link href="https://peter.palaga.org/2021/03/13/javaland.html" rel="alternate" type="text/html" title="My talks on JavaLand 2021" /><published>2021-03-13T00:00:00+00:00</published><updated>2021-03-13T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/03/13/javaland</id><content type="html" xml:base="https://peter.palaga.org/2021/03/13/javaland.html">&lt;h1&gt;My talks on JavaLand 2021&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am giving two talks on &lt;a href=&quot;https://www.javaland.eu/de/home/&quot;&gt;JavaLand 2021&lt;/a&gt;.
One is Quarkus deep dive for Extension authors
and the second one is about integrating systems with Apache Camel on Quarkus, Knative and Kafka Connect.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;will_my_library_or_framework_work_on_quarkus_and_graalvm&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#will_my_library_or_framework_work_on_quarkus_and_graalvm&quot;&gt;&lt;/a&gt;Will my library or framework work on Quarkus (and GraalVM)?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Wednesday March 17th 09:00 - 09:40 in Schauspielhaus, see &lt;a href=&quot;https://programm.javaland.eu/2021/#/scheduledEvent/606575&quot;&gt;JavaLand Schedule&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://peter.palaga.org/presentations/210317-quarkus-for-extension-authors/index.html&quot;&gt;Slides&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Abstract: Let&amp;#8217;s unveil the magic behind Quarkus!
Quarkus makes fast boot times and low memory consumption of Java applications possible thanks to a technique called Compile time boot.
Quarkus extensions are its main building blocks.
They optimize applications by doing as much work as possible at compile time instead of repeating it on each boot.
This may include tasks like parsing configuration files, annotation lookups, building framework metamodel, etc.
We will explain how Quarkus extensions work by writing one from scratch.
You will be guided through several typical problems and their solutions that occur when porting libraries and frameworks to Quarkus and GraalVM.
The talk is aimed at potential authors and contributors of Quarkus extensions as well as everybody curious about Quarkus internals.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;integrating_systems_in_the_age_of_quarkus_knative_and_kafka&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#integrating_systems_in_the_age_of_quarkus_knative_and_kafka&quot;&gt;&lt;/a&gt;Integrating systems in the age of Quarkus, Knative and Kafka&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Wednesday March 17th 17:00 - 17:40 in Quantum, see &lt;a href=&quot;https://programm.javaland.eu/2021/#/scheduledEvent/606579&quot;&gt;JavaLand Schedule&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://peter.palaga.org/presentations/210317-camel/index.html&quot;&gt;Slides&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Abstract: Apache Camel has been the Swiss knife of integrating heterogeneous systems for more than a decade.
Let&amp;#8217;s check how the humpy ungulate adapts to the newest changes in the environment!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Apache Camel integrations written on top of Quarkus start in a matter of milliseconds and consume just a few tens of megabytes of RAM.
We will explain the technology and show a live demo including the famous Quarkus dev mode.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then you will learn how the outstanding integration capabilities of Apache Camel enrich the serverless architectures based on Knative.
We will touch topics like auto-scaling and scaling to zero as well as content based routing of cloud events.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Finally, we will introduce the youngest member of the Camel family: the Camel Kafka Connector.
It brings the possibility to scalably and reliably stream data between Apache Kafka and the 300+ kinds of systems supported by Apache Camel.
We will clarify the underlying concepts and show how to use it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&amp;#160;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am looking forward to see you there!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="quarkus" /><category term="camel" /><summary type="html">My talks on JavaLand 2021 I am giving two talks on JavaLand 2021. One is Quarkus deep dive for Extension authors and the second one is about integrating systems with Apache Camel on Quarkus, Knative and Kafka Connect.</summary></entry><entry><title type="html">How to compile and install Stunt Rally on Fedora</title><link href="https://peter.palaga.org/2021/03/06/compile-and-install-stunt-rally-on-fedora.html" rel="alternate" type="text/html" title="How to compile and install Stunt Rally on Fedora" /><published>2021-03-06T00:00:00+00:00</published><updated>2021-03-06T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/03/06/compile-and-install-stunt-rally-on-fedora</id><content type="html" xml:base="https://peter.palaga.org/2021/03/06/compile-and-install-stunt-rally-on-fedora.html">&lt;h1&gt;How to compile and install Stunt Rally on Fedora&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/2021-03-06-install-stunt-rally-on-fadora/stuntrally.png&quot; alt=&quot;Stunt rally&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Stunt Rally is an open source racing game, one of a few available for Linux. It caught the attention of my son because it supports network mutiplayer mode as well as split screen multiplayer mode. As of writing this, there does not seem to exist an RPM package. There are &lt;a href=&quot;https://snapcraft.io/stuntrally&quot;&gt;SNAP&lt;/a&gt; and &lt;a href=&quot;https://flathub.org/apps/details/org.tuxfamily.StuntRally&quot;&gt;Flatpack&lt;/a&gt; packages which I have not tried. If you do not want those for any reason, you might find this compilation guide useful.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;prerequisites&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#prerequisites&quot;&gt;&lt;/a&gt;Prerequisites&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On Fedora 32, I had to install the following prerequisites  to be able to compile:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;sudo dnf install -y boost-devel cmake hicolor-icon-theme desktop-file-utils mygui-devel ogre-devel ois-devel enet-devel SDL2-devel libvorbis-devel libXcursor-devel bullet-devel bullet-extras-devel shiny-devel tinyxml-devel tinyxml2-devel ogre-pagedgeometry-devel dejavu-lgc-sans-fonts liberation-sans-fonts bitstream-vera-sans-fonts bitstream-vera-sans-mono-fonts openal-soft-devel cmake g++ git&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;clone_the_source_repositories&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#clone_the_source_repositories&quot;&gt;&lt;/a&gt;Clone the source repositories&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Starting from here, the steps are actually the same as on the &lt;a href=&quot;https://stuntrally.tuxfamily.org/wiki/doku.php?id=compile&quot;&gt;Stunt Rally wiki&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;git clone git://github.com/stuntrally/stuntrally.git
cd stuntrally
SR_HOME=&amp;quot;$(PWD)&amp;quot;
# get the tracks
cd data
git clone --depth=1 git://github.com/stuntrally/tracks.git&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;enable_the_master_server_compilation_target_optional&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#enable_the_master_server_compilation_target_optional&quot;&gt;&lt;/a&gt;Enable the master server compilation target (optional)&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to play in multiplayer mode,
having your own master server makes joining the game easier than direct connect.
Direct connect works too, but master server saves you some typing and clicking.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To enable the master server compilation target, add &lt;code&gt;-DBUILD_MASTER_SERVER=ON&lt;/code&gt; to the &lt;code&gt;cmake&lt;/code&gt; command below&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;compile_the_game&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#compile_the_game&quot;&gt;&lt;/a&gt;Compile the game&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;cd &amp;quot;${SR_HOME}&amp;quot;
mkdir build
cd build

cmake -DBUILD_MASTER_SERVER=ON ..
make -j4        # Compile using 4 threads (change to your number of CPUs)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;install_optional&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#install_optional&quot;&gt;&lt;/a&gt;Install (optional)&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;sudo make install&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;play_the_game_single_player&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#play_the_game_single_player&quot;&gt;&lt;/a&gt;Play the game (single player)&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;${SR_HOME}/stuntrally&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;play_multiplayer&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#play_multiplayer&quot;&gt;&lt;/a&gt;Play multiplayer&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;server&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#server&quot;&gt;&lt;/a&gt;Server&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On the machine that will fulfill the server role, create a script like the following and name it e.g. &lt;code&gt;sr.sh&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;#!/bin/bash
set -x
set -e

# change to where you have the stuntrally and sr-masterserver binaries
SR_HOME=path/to/build

cd &amp;quot;${SR_HOME}&amp;quot;

# start the server

./sr-masterserver -p 4242 -V &amp;amp;

# start the game
./stuntrally

# kill the server after exiting the game
killall sr-masterserver&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then open the ports&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;firewall-cmd --add-port=4242/udp --permanent
firewall-cmd --add-port=4243/udp --permanent&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Start the game and master server using the &lt;code&gt;sr.sh&lt;/code&gt; script&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;sr.sh&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the game, go to Multiplayer &amp;gt; Settings&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/2021-03-06-install-stunt-rally-on-fadora/multiplayer-settings.png&quot; alt=&quot;Multiplayer &amp;gt; Settings&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;Leave Local port unchanged&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Change the Master server IP to an address or hostname of the current machine your clients can access&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Change the Port to 4242&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Switch to Server tab and click Create game&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/2021-03-06-install-stunt-rally-on-fadora/create-game.png&quot; alt=&quot;Create game&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;clients&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#clients&quot;&gt;&lt;/a&gt;Clients&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Start the game as usual&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;${SR_HOME}/stuntrally&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Go to Multiplayer &amp;gt; Settings and perform the same changes as on the server&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/2021-03-06-install-stunt-rally-on-fadora/multiplayer-settings.png&quot; alt=&quot;Multiplayer &amp;gt; Settings&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;Leave Local port unchanged&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Change the Master server IP to an address or hostname of the current machine your clients can access&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Change the Port to 4242&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Switch to Server tab and click Get/refresh list. The game created on the server should appear in the list.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/2021-03-06-install-stunt-rally-on-fadora/refresh-list.png&quot; alt=&quot;Get/refresh list&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Select the game and click Join game below.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After that, the client should be visible in the list of players in the Game tab.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once all clients click the green Ready button, the game can be started on the server by pressing the green Start button.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="games" /><summary type="html">How to compile and install Stunt Rally on Fedora Stunt Rally is an open source racing game, one of a few available for Linux. It caught the attention of my son because it supports network mutiplayer mode as well as split screen multiplayer mode. As of writing this, there does not seem to exist an RPM package. There are SNAP and Flatpack packages which I have not tried. If you do not want those for any reason, you might find this compilation guide useful.</summary></entry><entry><title type="html">Grouping Quarkus extension tests for faster execution</title><link href="https://peter.palaga.org/2021/02/16/grouping-quarkus-extension-tests.html" rel="alternate" type="text/html" title="Grouping Quarkus extension tests for faster execution" /><published>2021-02-16T00:00:00+00:00</published><updated>2021-02-16T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/02/16/grouping-quarkus-extension-tests</id><content type="html" xml:base="https://peter.palaga.org/2021/02/16/grouping-quarkus-extension-tests.html">&lt;h1&gt;Grouping Quarkus extension tests for faster execution&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Testing is a substantial ingredient of software quality.
Projects producing Quarkus extensions are not an exception.
While testing on traditional JVMs is rather fast and well understood,
testing GraalVM native executables brings new challenges, especially because it takes long:
It is one or more minutes for common test projects that we have in &lt;a href=&quot;https://github.com/apache/camel-quarkus&quot;&gt;Camel Quarkus&lt;/a&gt;.
Multiply it with our
&lt;a href=&quot;https://camel.apache.org/camel-quarkus/latest/reference/index.html&quot;&gt;~300 extensions&lt;/a&gt;
and you end up with tens of hours for a single pass of the CI.
Let&amp;#8217;s discuss some ways how to speed up the native testing,
esp. by merging several test modules into a single test module.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;quarkus_extension_testing_an_intro&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#quarkus_extension_testing_an_intro&quot;&gt;&lt;/a&gt;Quarkus extension testing: An intro&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;(Feel free to skip this if you know well how Quarkus extension tests work.)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Here we primarily speak about integration tests that typically consist of a small application in &lt;code&gt;src/main&lt;/code&gt;
and a couple of tests in &lt;code&gt;src/test&lt;/code&gt; that validate the behavior of the application.
The test module is supposed to depend on the tested extension
and the application is supposed to make use of that extension.
As an example, look at e.g.
the &lt;a href=&quot;https://github.com/apache/camel-quarkus/tree/master/integration-tests/activemq&quot;&gt;ActiveMQ test&lt;/a&gt;
in Camel Quarkus source tree.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are test classes of two kinds in &lt;code&gt;src/test/java&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;Ending with &lt;code&gt;Test&lt;/code&gt; - those are for testing in JVM mode&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ending with &lt;code&gt;IT&lt;/code&gt; - for testing in native mode.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;While the JVM tests are run in the same JVM as the application under test,
the native tests are run in a process separate from the application.
This is because in the latter case the application is compiled to native executable
and that executable is run standalone (without any JVM).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For this very reason, native tests must communicate with the tested application via network (or filesystem, etc.).
In JVM tests, there are a couple of other options, like directly injecting beans via CDI.
We avoid using this in Camel Quarkus, because our &lt;code&gt;*IT&lt;/code&gt; tests inherit from their &lt;code&gt;*Test&lt;/code&gt; counterparts
so that JVM tests generally check the same functionality as native tests.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As we have pointed out already,
compiling the test application to native executable takes a substantial portion of the overall testing time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Which options are there to speed it up?&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;parallelize_the_execution&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#parallelize_the_execution&quot;&gt;&lt;/a&gt;Parallelize the execution&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Of course Quarkus integration tests can be run in parallel on multiple worker nodes.
It is easy to implement in environments like GitHub Actions and indeed, we are keen on
&lt;a href=&quot;https://github.com/apache/camel-quarkus/blob/9c381417e09c1e3e9bee574a41fcf5b3a6b99c7d/.github/workflows/ci-build.yaml#L109&quot;&gt;utilizing&lt;/a&gt; it in Camel Quarkus.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The not-so-good news is that GitHub Actions
&lt;a href=&quot;https://docs.github.com/en/actions/reference/usage-limits-billing-and-administration#usage-limits&quot;&gt;limits&lt;/a&gt;
the number of concurrent jobs to 20 (in the free tier at least).
That currently makes our pull request verification to take around two hours
which is still outside of my comfort zone.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;What other optimizations can be implemented?&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;incremental_testing&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#incremental_testing&quot;&gt;&lt;/a&gt;Incremental testing&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Falko Modler works on introducing
&lt;a href=&quot;https://github.com/gitflow-incremental-builder/gitflow-incremental-builder&quot;&gt;Gitflow incremental builder&lt;/a&gt;
to Quarkus. While it has tremendous potential, it is still &lt;a href=&quot;https://github.com/quarkusio/quarkus/pull/13243&quot;&gt;work in progress&lt;/a&gt;.
Let&amp;#8217;s wait and see how well it goes in Quarkus.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;grouping_of_extension_tests&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#grouping_of_extension_tests&quot;&gt;&lt;/a&gt;Grouping of extension tests&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is actually the idea I wanted this blog post to be about ðŸ™‚.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The core hypothesis of this approach is that the native compilation of an application
consisting of JARs A, B and C
generally takes less time than the sum of compilation times of two separate applications consisting of
(1) A and B and (2) A and C respectively.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Here, A is thought to be some common base that is found in both (1) and (2).
We typically have this situation in our integration tests
- they all contain &lt;code&gt;quarkus-core&lt;/code&gt;, &lt;code&gt;camel-quarkus-core&lt;/code&gt;, &lt;code&gt;quarkus-resteasy&lt;/code&gt;
(plus all their transitive dependencies)
and last but not least all the Java runtime classes.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We assume that especially for test modules, whose dependency sets differ by just a few small JARs,
&quot;merging&quot; them together into a single module may save some native compilation time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We actually did this since a log time, e.g. with our AWS extensions,
but nobody bothered to gather some real numbers to confirm or deny the hypothesis.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;what_could_go_wrong&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#what_could_go_wrong&quot;&gt;&lt;/a&gt;What could go wrong?&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Before I show you the benchmarks, let&amp;#8217;s discuss what are the risks and drawbacks of test grouping.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/nethertron2000&quot;&gt;James&lt;/a&gt; pointed out once that &quot;extensions may fix each other&quot;.
If extension A forgets to register some class for reflection that extension B does register, then,
when the two are used together in an application, B provides the necessary config and the tests pass.
However, if A would be alone without B in a test application the tests would fail
because the registration for reflection is missing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For this reason, hard coding multiple extensions' tests into a single test module might be risky.
Ideally, it should be possible to have both:
the faster grouped setup for pull request verification
and the slower but methodologically cleaner isolated setup for proper nightly/weekly/pre-release verification.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;semi_automatic_grouping&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#semi_automatic_grouping&quot;&gt;&lt;/a&gt;Semi-automatic grouping&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I have recently split a couple of
&lt;a href=&quot;https://github.com/apache/camel-quarkus/tree/master/integration-tests-aws2&quot;&gt;AWS tests&lt;/a&gt;
properly and I have also put
&lt;a href=&quot;https://github.com/apache/camel-quarkus/blob/83e5c768b6196de7a7fb04990c3a40e2a22d24f7/integration-tests/aws2-grouped/pom.xml#L44&quot;&gt;some&lt;/a&gt;
&lt;a href=&quot;https://github.com/apache/camel-quarkus/blob/83e5c768b6196de7a7fb04990c3a40e2a22d24f7/integration-tests/aws2-grouped/pom.xml#L218-L238&quot;&gt;tooling&lt;/a&gt; in place that generates the
grouped module semi-automatically.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In that way it is easy to run the tests both in isolation and grouped whichever suits better for the given use case.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And thanks to this setup, it is also quite easy to compare the duration of the grouped and isolated execution.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;benchmarks&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#benchmarks&quot;&gt;&lt;/a&gt;Benchmarks&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;My measurements were not perfectly scientific, because I performed just a single round and I had other programs running.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;My machine:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;AMD Ryzen Threadripper 1920X, 12 cores @ 2162 MHz&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;64 GB RAM&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HDD SSD Samsung 970 EVO&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Fedora 31&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Here are the numbers:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/2021-02-16-grouping-quarkus-extension-tests/benchmarks.png&quot; alt=&quot;Grouping vs. duration&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;table class=&quot;tableblock frame-all grid-all stretch&quot;&gt;
&lt;colgroup&gt;
&lt;col style=&quot;width: 50%;&quot;&gt;
&lt;col style=&quot;width: 50%;&quot;&gt;
&lt;/colgroup&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Grouping&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Duration (sec)&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Isolated&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;620&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Grouped&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;321&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The time difference is about 5 minutes and it might be a bit more on slowish CI worker nodes.
That&amp;#8217;s definitely worth the effort!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;possible_next_step&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#possible_next_step&quot;&gt;&lt;/a&gt;Possible next step&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We are planning to add more AWS tests in the near future.
It will be interesting to see how the grouped module scales with the number of tested extensions.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;steps_to_reproduce&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#steps_to_reproduce&quot;&gt;&lt;/a&gt;Steps to reproduce&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;export GRAALVM_HOME=...
$ $GRAALVM_HOME/bin/java -version
openjdk version &amp;quot;11.0.10&amp;quot; 2021-01-19
OpenJDK Runtime Environment GraalVM CE 20.3.1 (build 11.0.10+8-jvmci-20.3-b09)
OpenJDK 64-Bit Server VM GraalVM CE 20.3.1 (build 11.0.10+8-jvmci-20.3-b09, mixed mode, sharing)

# clone Camel Quarkus
$ git clone git@github.com:apache/camel-quarkus.git
$ cd camel-quarkus
$ CQ_HOME=$(pwd)

# This is the revision I worked with:
$ git reset --hard 83e5c768b6196de7a7fb04990c3a40e2a22d24f7

# Build the whole tree without tests
$ mvn clean install -Dquickly

# Run the isolated tests, both JVM and native
$ cd $CQ_HOME/integration-tests-aws2
$ mvn clean verify -Pnative
# record the duration reported by Maven

# Run the grouped tests, both JVM and native
$ cd $CQ_HOME/integration-tests/aws2-grouped
$ mvn clean verify -Pnative
# record the duration reported by Maven&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&amp;#160;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Thanks for reading and stay &lt;a href=&quot;https://twitter.com/ppalaga&quot;&gt;tuned&lt;/a&gt; for more posts about Quarkus, GraalVM, Apache Camel and &lt;code&gt;mvnd&lt;/code&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="quarkus" /><summary type="html">Grouping Quarkus extension tests for faster execution Testing is a substantial ingredient of software quality. Projects producing Quarkus extensions are not an exception. While testing on traditional JVMs is rather fast and well understood, testing GraalVM native executables brings new challenges, especially because it takes long: It is one or more minutes for common test projects that we have in Camel Quarkus. Multiply it with our ~300 extensions and you end up with tens of hours for a single pass of the CI. Let&amp;#8217;s discuss some ways how to speed up the native testing, esp. by merging several test modules into a single test module.</summary></entry><entry><title type="html">Using GraalVM native-image-agent when porting a library to Quarkus</title><link href="https://peter.palaga.org/2021/01/31/using-native-image-agent-when-porting-a-lib-to-quarkus.html" rel="alternate" type="text/html" title="Using GraalVM native-image-agent when porting a library to Quarkus" /><published>2021-01-31T00:00:00+00:00</published><updated>2021-01-31T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/01/31/using-native-image-agent-when-porting-a-lib-to-quarkus</id><content type="html" xml:base="https://peter.palaga.org/2021/01/31/using-native-image-agent-when-porting-a-lib-to-quarkus.html">&lt;h1&gt;Using GraalVM &lt;code&gt;native-image-agent&lt;/code&gt; when porting a library to Quarkus&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I pondered a bit how &lt;a href=&quot;https://www.graalvm.org/reference-manual/native-image/BuildConfiguration/#assisted-configuration-of-native-image-builds&quot;&gt;GraalVM&amp;#8217;s &lt;code&gt;native-image-agent&lt;/code&gt;&lt;/a&gt; can be leveraged when writing Quarkus extensions.
Even if the configuration produced by it wonâ€™t be 100% complete and relevant, it may give you a good initial impression
where to look and which kinds of problems you need to solve.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;background&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#background&quot;&gt;&lt;/a&gt;Background&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Native compilation of Java using GraalVM&amp;#8217;s &lt;code&gt;native-image&lt;/code&gt; tool typically requires a lot of
&lt;a href=&quot;https://www.graalvm.org/reference-manual/native-image/BuildConfiguration/&quot;&gt;configuration&lt;/a&gt;.
You need to list classes/methods/fields that require reflection, you need to register proxies,
you need to declare which classes have to be initialized at runtime instead of build time, etc.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you are on &lt;a href=&quot;https://quarkus.io/&quot;&gt;Quarkus&lt;/a&gt;, you usually do not need to care for these nitty-gritty details
because Quarkus does it for you under the hood and &lt;code&gt;mvn package -Dnative&lt;/code&gt; is all you need to know.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But say, that you are not so lucky to have a ready to use Quarkus extension for some library and you want to write one.
Folks who are not able or not wanting to use Quarkus are actually in quite a similar situation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;configuring_native_image&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#configuring_native_image&quot;&gt;&lt;/a&gt;Configuring &lt;code&gt;native-image&lt;/code&gt;&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So how can the &lt;code&gt;native-image&lt;/code&gt; configuration be put together? Generally speaking there are three options:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;a_pure_knowledge&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#a_pure_knowledge&quot;&gt;&lt;/a&gt;A. Pure knowledge&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You are a GraalVM guru and you know your complete class path so well
that you can write your &lt;code&gt;native-image&lt;/code&gt; configuration from top of your head.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Well, this is probably not your case, because you are reading this blog post ðŸ˜œ&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;b_trial_and_error&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#b_trial_and_error&quot;&gt;&lt;/a&gt;B. Trial and error&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You first try to compile your application with no configuration at all.
If the compilation fails, you try to understand the error message and fix what&amp;#8217;s necessary.
If the message does not make any sense to you, you paste it to google and you hope to find a solution.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once the compilation succeeds, you start testing the native executable.
It may fail with some &lt;code&gt;ClassNotFoundException&lt;/code&gt; if you forgot to register some class for reflection
or with a &lt;code&gt;NullPointerException&lt;/code&gt; if you forgot to embed some resources to the native image.
It may also fail with some cryptic exception that you have no clue about.
You google again and you either find a solution that works for you
or you see only reports of frustration similar to your own.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;c_native_image_agent&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#c_native_image_agent&quot;&gt;&lt;/a&gt;C. &lt;code&gt;native-image-agent&lt;/code&gt;&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The official &lt;a href=&quot;https://www.graalvm.org/reference-manual/native-image/BuildConfiguration/#assisted-configuration-of-native-image-builds&quot;&gt;recommendation of GraalVM&lt;/a&gt; is to use their &lt;code&gt;native-image-agent&lt;/code&gt;.
You are supposed to put your application (with the agent attached) under a load
that hits all execution paths that will be active also in production.
Based on the runtime data, the agent outputs a configuration in a format acceptable for &lt;code&gt;native-image&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This sounds very promising, but of course the main caveat is that
if you are unable to simulate the production load properly during the test runs,
then the produced configuration will not be complete.
Your native application may thus fail in production.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Besides that, the agent records only the usage of some features (namely JNI, Reflection, Proxies and class path resources)
while it does not help with configuring others, like delayed class initialization.
So you still may have to assemble some parts of the configuration manually.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;native_image_vs_quarkus&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#native_image_vs_quarkus&quot;&gt;&lt;/a&gt;&lt;code&gt;native-image&lt;/code&gt; vs. Quarkus&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;native-image-agent&lt;/code&gt; was designed for use on plain GraalVM, without Quarkus.
How can we benefit from it when writing Quarkus extensions?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The main idea here is to attach it to the JVM running the application against which we run integration tests.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;write_tests_first&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#write_tests_first&quot;&gt;&lt;/a&gt;Write tests first&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When porting a library or framework to Quarkus, I always start with writing some tests.
Ideally, they should be integration tests.
It means that there should be a real Quarkus application in &lt;code&gt;src/main/java&lt;/code&gt;
and the tests should communicate with it only via network protocols, like HTTP.
The tests should cover all important use cases of the ported library.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock tip&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;i class=&quot;fa icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Check &lt;a href=&quot;https://quarkus.io/guides/getting-started-testing&quot;&gt;Quarkus testing guide&lt;/a&gt;
to learn how to write integration tests for Quarkus applications.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If I am extremely lucky, the tests just pass in native mode
and the library can be considered working in native without any native image configuration.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But that&amp;#8217;s very rare. The tests usually pass in JVM mode and they fail in native mode
because some piece of &lt;code&gt;native-image&lt;/code&gt; configuration is missing.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;run_tests_with_native_image_agent_attached&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#run_tests_with_native_image_agent_attached&quot;&gt;&lt;/a&gt;Run tests with &lt;code&gt;native-image-agent&lt;/code&gt; attached&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you do not know the internals of the ported library well, &lt;code&gt;native-image-agent&lt;/code&gt; may come in very handy.
Even if the configuration produced by it won&amp;#8217;t be 100% complete and relevat,
it may give you a good initial impression where to look and which kinds of problems you need to solve.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;How can you attach &lt;code&gt;native-image-agent&lt;/code&gt; to your tests?
Let me explain first how
&lt;a href=&quot;https://quarkus.io/guides/getting-started-testing#recap-of-http-based-testing-in-jvm-mode&quot;&gt;Quarkus JVM tests&lt;/a&gt;
annotated with &lt;code&gt;@QuarkusTest&lt;/code&gt; work.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When running the tests from Maven via &lt;code&gt;mvn test&lt;/code&gt; there are two JVMs taking part in the game:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;The main Maven JVM&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A separate JVM started by surefire to run the tests&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Should &lt;code&gt;native-image-agent&lt;/code&gt; be attached to the second one?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;While it is certainly the better of the two options, it is still not perfect.
The problem is that this JVM is used not only to run the application under test (living under &lt;code&gt;src/main&lt;/code&gt;),
but also the test code living under &lt;code&gt;src/test&lt;/code&gt;.
Clearly, we do not intend to compile the tests to native. We only want to compile the application.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So, how can we split the second JVM into a test JVM and an application JVM?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I have found the following hammer-and-nails procedure (please &lt;a href=&quot;https://twitter.com/ppalaga&quot;&gt;let me know&lt;/a&gt; if you know a better one):&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;Remove the &lt;code&gt;@QuarkusTest&lt;/code&gt; annotation from all your test classes.
Why? Because otherwise Quarkus JUnit extension would start the application in the test JVM
and that&amp;#8217;s exactly what we&amp;#8217;d like to avoid.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Package your application skipping the tests&lt;/p&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ mvn clean package -DskipTests&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Start your application manually using GraalVM JRE (in which &lt;code&gt;native-image-agent&lt;/code&gt; is available)
with the agent attached and &lt;code&gt;test&lt;/code&gt; Quarkus profile activated:&lt;/p&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ export JAVA_HOME=/path/to/graalvm-ce-java11-...
$ $JAVA_HOME/bin/java -agentlib:native-image-agent=config-output-dir=target/graal-config&amp;quot; -Dquarkus.profile=test -jar target/*-runner.jar
...
2021-01-31 15:58:31,675 INFO  [io.quarkus] (main) Profile test activated.
2021-01-31 15:58:31,676 INFO  [io.quarkus] (main) Installed features: [..., cdi, resteasy]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Run the tests in another terminal:&lt;/p&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ mvn test # or alternatively mvn surefire:test might suffice too
...
[INFO] BUILD SUCCESS&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;When all the tests have passed, terminate the application running in the first terminal by pressing &lt;code&gt;CTRL+C&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After that, the configuration for &lt;code&gt;native-image&lt;/code&gt; should be stored in &lt;code&gt;target/graal-config&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ tree target/graal-config
target/graal-config
â”œâ”€â”€ proxy-config.json
â”œâ”€â”€ reflect-config.json
â”œâ”€â”€ resource-config.json
â””â”€â”€ ...&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;sect3&quot;&gt;
&lt;h4 id=&quot;update_2021_02_17&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#update_2021_02_17&quot;&gt;&lt;/a&gt;Update 2021-02-17:&lt;/h4&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/helpermethod/status/1362023754033987584&quot;&gt;Oliver Weiler&lt;/a&gt; proposed another approach:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can use the Surefire JVM,
but ignore all test-related classes by supplying an &lt;code&gt;access-filter.json&lt;/code&gt; file to the &lt;code&gt;native-image-agent&lt;/code&gt;.
See &lt;a href=&quot;https://www.graalvm.org/reference-manual/native-image/BuildConfiguration/#access-filters&quot;&gt;Access Filters docs&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;translate_the_generated_config_to_quarkus_builditems&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#translate_the_generated_config_to_quarkus_builditems&quot;&gt;&lt;/a&gt;Translate the generated config to Quarkus &lt;code&gt;BuildItems&lt;/code&gt;&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once the &lt;code&gt;native-image-agent&lt;/code&gt; has generated the configuration, you can study the content of the files
and consider whether and how you need to translate the individual items to Quarkus &lt;code&gt;BuildItems&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock tip&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;i class=&quot;fa icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Check &lt;a href=&quot;https://quarkus.io/guides/writing-extensions&quot;&gt;Quarkus for extension authors&lt;/a&gt; to learn Quarkus extensions basics.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You typically do not need to care for all configuration items
because some of them are already covered by some core Quarkus extension,
such as &lt;code&gt;quarkus-netty&lt;/code&gt;, &lt;code&gt;quarkus-jackson&lt;/code&gt;, &lt;code&gt;quarkus-vertx&lt;/code&gt;, etc.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For the ones that are apparently related to the library you are porting, the mapping goes like the following:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;proxy-config.json&lt;/code&gt; â†’ &lt;code&gt;&lt;a href=&quot;https://github.com/quarkusio/quarkus/blob/master/core/deployment/src/main/java/io/quarkus/deployment/builditem/nativeimage/NativeImageProxyDefinitionBuildItem.java&quot;&gt;NativeImageProxyDefinitionBuildItem&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;reflect-config.json&lt;/code&gt; â†’ &lt;code&gt;&lt;a href=&quot;https://github.com/quarkusio/quarkus/blob/master/core/deployment/src/main/java/io/quarkus/deployment/builditem/nativeimage/ReflectiveClassBuildItem.java&quot;&gt;ReflectiveClassBuildItem&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;resource-config.json&lt;/code&gt; â†’ &lt;code&gt;&lt;a href=&quot;https://github.com/quarkusio/quarkus/blob/master/core/deployment/src/main/java/io/quarkus/deployment/builditem/nativeimage/NativeImageResourceBuildItem.java&quot;&gt;NativeImageResourceBuildItem&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a href=&quot;https://github.com/quarkusio/quarkus/blob/master/core/deployment/src/main/java/io/quarkus/deployment/builditem/nativeimage/NativeImageResourceBundleBuildItem.java&quot;&gt;NativeImageResourceBundleBuildItem&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock tip&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;i class=&quot;fa icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Check &lt;a href=&quot;https://quarkus.io/guides/all-builditems&quot;&gt;Quarkus &lt;code&gt;BuildItem&lt;/code&gt;s reference&lt;/a&gt; for more details about the available &lt;code&gt;BuildItem&lt;/code&gt;s.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Example: If you have something like the following in your &lt;code&gt;reflect-config.json&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;json&quot;&gt;[
{
  &lt;span class=&quot;key&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;com.azure.core.util.DateTimeRfc1123&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;,
  &lt;span class=&quot;key&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;allDeclaredFields&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt;true&lt;/span&gt;,
  &lt;span class=&quot;key&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;allDeclaredMethods&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt;true&lt;/span&gt;,
  &lt;span class=&quot;key&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;allDeclaredConstructors&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt;true&lt;/span&gt;
},
{
  &lt;span class=&quot;key&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;com.azure.storage.blob.implementation.models.BlobsGetPropertiesResponse&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;,
  &lt;span class=&quot;key&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;allDeclaredConstructors&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt;true&lt;/span&gt;
}
]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;this is how you would translate it to a Quarkus &lt;code&gt;@BuildStep&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;java&quot;&gt;&lt;span class=&quot;type&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;AzureBuildSteps&lt;/span&gt; {

    &lt;span class=&quot;annotation&quot;&gt;@BuildStep&lt;/span&gt;
    &lt;span class=&quot;type&quot;&gt;void&lt;/span&gt; reflectiveClasses(BuildProducer&amp;lt;ReflectiveClassBuildItem&amp;gt; reflectiveClasses) {

        reflectiveClasses.produce(
                &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ReflectiveClassBuildItem(
                        &lt;span class=&quot;predefined-constant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// allDeclaredMethods required&lt;/span&gt;
                        &lt;span class=&quot;predefined-constant&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// allDeclaredFields required&lt;/span&gt;
                        &lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;com.azure.core.util.DateTimeRfc1123&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;));

        reflectiveClasses.produce(
                &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ReflectiveClassBuildItem(
                        &lt;span class=&quot;predefined-constant&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// allDeclaredMethods not required&lt;/span&gt;
                        &lt;span class=&quot;predefined-constant&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// allDeclaredFields not required&lt;/span&gt;
                        &lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;com.azure.storage.blob.implementation.models.BlobsGetPropertiesResponse&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;));

    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;is_that_all&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#is_that_all&quot;&gt;&lt;/a&gt;Is that all?&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Not necessarily.
As I have mentioned above, &lt;code&gt;native-image-agent&lt;/code&gt; does not handle all aspects of the configuration.
Running the tests in native mode may reveal more issues that may require additional &lt;code&gt;BuildItem&lt;/code&gt;s
or even GraalVM &lt;a href=&quot;https://github.com/oracle/graal/blob/2c334c4db1ccd09b1a7ec5abdabad2e8ffe2d407/substratevm/src/com.oracle.svm.core/src/com/oracle/svm/core/annotate/TargetClass.java#L36-L70&quot;&gt;substitutions&lt;/a&gt;.
That&amp;#8217;s already beyond the scope of this blog post where I primarily wanted to show
how &lt;code&gt;native-image-agent&lt;/code&gt; can be leveraged when writing Quarkus extensions.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Thanks for reading, stay &lt;a href=&quot;https://twitter.com/ppalaga&quot;&gt;tuned&lt;/a&gt; for more posts about Quarkus, GraalVM, Apache Camel and &lt;code&gt;mvnd&lt;/code&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="quarkus" /><summary type="html">Using GraalVM native-image-agent when porting a library to Quarkus I pondered a bit how GraalVM&amp;#8217;s native-image-agent can be leveraged when writing Quarkus extensions. Even if the configuration produced by it wonâ€™t be 100% complete and relevant, it may give you a good initial impression where to look and which kinds of problems you need to solve.</summary></entry><entry><title type="html">mvnd tip: Solving common issues of parallel builds</title><link href="https://peter.palaga.org/2021/01/12/mvnd-solving-common-issues-of-parallel-builds.html" rel="alternate" type="text/html" title="mvnd tip: Solving common issues of parallel builds" /><published>2021-01-12T00:00:00+00:00</published><updated>2021-01-12T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/01/12/mvnd-solving-common-issues-of-parallel-builds</id><content type="html" xml:base="https://peter.palaga.org/2021/01/12/mvnd-solving-common-issues-of-parallel-builds.html">&lt;h1&gt;&lt;code&gt;mvnd&lt;/code&gt; tip: Solving common issues of parallel builds&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the &lt;a href=&quot;/2021/01/11/mvnd-parallel-builds.html#smart_builder_by_default&quot;&gt;previous &lt;code&gt;mvnd&lt;/code&gt; tip&lt;/a&gt;, we have introduced
&lt;code&gt;mvnd&lt;/code&gt;'s &lt;code&gt;smart&lt;/code&gt; builder and explained how it works. Today, I&amp;#8217;d like discuss various issues you may hit when
migrating from Maven &lt;code&gt;singlethreaded&lt;/code&gt; builder and I&amp;#8217;ll propose some solutions.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;hidden_dependencies_between_modules&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#hidden_dependencies_between_modules&quot;&gt;&lt;/a&gt;Hidden dependencies between modules&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Switching to &lt;code&gt;mvnd&lt;/code&gt; and its &lt;code&gt;smart&lt;/code&gt; builder may reveal that modules in your source tree have some hidden
dependencies. You may have never noticed these when building with standard Maven&amp;#8217;s &lt;code&gt;singlethreaded&lt;/code&gt; builder,
because it orders the modules deterministically not only based on explicit &lt;code&gt;&amp;lt;dependency&amp;gt;&lt;/code&gt; relationships, but also
based on the order of modules in the &lt;code&gt;&amp;lt;modules&amp;gt;&lt;/code&gt; element. If your modules depend on each other like this&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;text&quot;&gt;    A
   / \
  B   C    (Lower depends on upper)
   \ /
    D&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;and if these modules are ordered like this in the parent &lt;code&gt;pom.xml&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;modules&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;module&amp;gt;&lt;/span&gt;A&lt;span class=&quot;tag&quot;&gt;&amp;lt;/module&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;module&amp;gt;&lt;/span&gt;B&lt;span class=&quot;tag&quot;&gt;&amp;lt;/module&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;module&amp;gt;&lt;/span&gt;C&lt;span class=&quot;tag&quot;&gt;&amp;lt;/module&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;module&amp;gt;&lt;/span&gt;D&lt;span class=&quot;tag&quot;&gt;&amp;lt;/module&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/modules&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;then with &lt;code&gt;singlethreaded&lt;/code&gt; Maven builder, the module &lt;code&gt;B&lt;/code&gt; is always completely built before the module &lt;code&gt;C&lt;/code&gt;.
The build will work fine even if &lt;code&gt;C&lt;/code&gt; has some non-explicit dependency on &lt;code&gt;B&lt;/code&gt;.
For instance, it could be reading a file in &lt;code&gt;B&lt;/code&gt;'s &lt;code&gt;target&lt;/code&gt; folder, its test could dynamically read an artifact
produced by module &lt;code&gt;B&lt;/code&gt; from the local Maven repository, etc.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;A build like this may start failing with &lt;code&gt;smart&lt;/code&gt; builder or &lt;code&gt;multithreaded&lt;/code&gt; builder.
Because concurrency is a part of the game, the failure may happen sporadically and the symptoms may include something like&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;File &lt;code&gt;B/target/whatever&lt;/code&gt; not found exception thrown during the build of module &lt;code&gt;C&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(On Windows) &lt;code&gt;clean&lt;/code&gt; unable to delete the file in &lt;code&gt;B/target&lt;/code&gt; because some part of the &lt;code&gt;C&lt;/code&gt; build is reading it, etc.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;remedy&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#remedy&quot;&gt;&lt;/a&gt;Remedy&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are more ways to solve this, but I am going to show you only the most generic one.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to instruct &lt;code&gt;smart&lt;/code&gt; or &lt;code&gt;multithreaded&lt;/code&gt; builder to build &lt;code&gt;B&lt;/code&gt; before &lt;code&gt;C&lt;/code&gt;, put the following dependency into &lt;code&gt;C&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.my-group&lt;span class=&quot;tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;B&lt;span class=&quot;tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${project.version}&lt;span class=&quot;tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;type&amp;gt;&lt;/span&gt;pom&lt;span class=&quot;tag&quot;&gt;&amp;lt;/type&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;exclusions&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;exclusion&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;*&lt;span class=&quot;tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;*&lt;span class=&quot;tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/exclusion&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/exclusions&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It won&amp;#8217;t add any real dependency to &lt;code&gt;C&lt;/code&gt; but it will guarantee that &lt;code&gt;B&lt;/code&gt; is fully built before &lt;code&gt;C&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;plugins_relying_on_global_mutable_state&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#plugins_relying_on_global_mutable_state&quot;&gt;&lt;/a&gt;Plugins relying on global mutable state&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Some Maven plugin used in your build may rely on some data stored in a mutable global variable.
Using Java system properties in the following way is a typical example:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;Java&quot;&gt;&lt;span class=&quot;annotation&quot;&gt;@Mojo&lt;/span&gt;(name = &lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;some-mojo&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;)
&lt;span class=&quot;directive&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;SomeMojo&lt;/span&gt; &lt;span class=&quot;directive&quot;&gt;extends&lt;/span&gt; AbstractMojo {
    &lt;span class=&quot;annotation&quot;&gt;@Parameter&lt;/span&gt;(property = &lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;project&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;, required = &lt;span class=&quot;predefined-constant&quot;&gt;true&lt;/span&gt;, readonly = &lt;span class=&quot;predefined-constant&quot;&gt;true&lt;/span&gt;)
    &lt;span class=&quot;directive&quot;&gt;protected&lt;/span&gt; MavenProject project;

    &lt;span class=&quot;annotation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;directive&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;type&quot;&gt;void&lt;/span&gt; execute() {
        &lt;span class=&quot;predefined-type&quot;&gt;System&lt;/span&gt;.setProperty(&lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;currentArtifactId&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;, project.getArtifact().getArtifactId());
        &lt;span class=&quot;comment&quot;&gt;// some code assuming that this instance of the mojo observes what we have set&lt;/span&gt;
        &lt;span class=&quot;comment&quot;&gt;// on the previous line&lt;/span&gt;
        &lt;span class=&quot;keyword&quot;&gt;assert&lt;/span&gt; project.getArtifact().getArtifactId().equals(&lt;span class=&quot;predefined-type&quot;&gt;System&lt;/span&gt;.getProperty(&lt;span class=&quot;string&quot;&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;content&quot;&gt;currentArtifactId&lt;/span&gt;&lt;span class=&quot;delimiter&quot;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;));
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the snippet above, the &lt;code&gt;currentArtifactId&lt;/code&gt; system property is set at the beginning of the &lt;code&gt;execute()&lt;/code&gt; method
and the author apparently assumes that the method cannot be called from multiple threads concurrently.
The assumption holds when building with the &lt;code&gt;singlethreaded&lt;/code&gt; builder,
but it does not with &lt;code&gt;smart&lt;/code&gt; and &lt;code&gt;multithreaded&lt;/code&gt; builders.
If modules are built in parallel, it may happen
that instance 2 of the mojo will overwrite the value of the property value set by instance 1 before the instance 1 can read it.
Instance 1 thus observes the value set by instance 2 and the assertion in the above snippet will fail.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;remedy_2&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#remedy_2&quot;&gt;&lt;/a&gt;Remedy&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The primary recommendation for this kind issue is to go and fix the given plugin.
Or at least report the issue in its issue tracker.
Or in case the issue was reported already, make sure that you upvote the issue so that the plugin author sees that the issue matters to you.
In that way the issue can be fixed once for all users of &lt;code&gt;mvnd&lt;/code&gt; and for all users of &lt;code&gt;multithreaded&lt;/code&gt; builder.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After reporting the issue, you may also consider &lt;a href=&quot;/2021/01/11/mvnd-parallel-builds.html#mavens_serial_builder_via_1_serial&quot;&gt;falling back to &lt;code&gt;singlethreaded&lt;/code&gt; builder&lt;/a&gt;. However, by doing that you&amp;#8217;ll loose one of the most important benefits of &lt;code&gt;mvnd&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;race_for_system_resources&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#race_for_system_resources&quot;&gt;&lt;/a&gt;Race for system resources&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The most prominent example of this kind of issue is opening sockets using a fixed port in modules built in parallel.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Say that your module dependencies are like this again&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;text&quot;&gt;    A
   / \
  B   C    (Lower depends on upper)
   \ /
    D&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;and say that both &lt;code&gt;B&lt;/code&gt; and &lt;code&gt;C&lt;/code&gt; contain some tests and that the tests in both modules start some helper service on a fixed port, e.g. &lt;code&gt;1234&lt;/code&gt;.
The service can be the application under test itself, a database, a message broker, etc.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am sure you see the problem:
the tests either in &lt;code&gt;B&lt;/code&gt; or in &lt;code&gt;C&lt;/code&gt; won&amp;#8217;t be able to start the service,
because the port is already occupied by the service started from the other module.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;remedy_3&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#remedy_3&quot;&gt;&lt;/a&gt;Remedy&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;When it comes to solutions, I suggest you first decide for yourself, whether running tests in parallel is a goal worth pursuing at all.
Maybe it is too much work, maybe the test isolation is hard to guarantee.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I generally do not do it and I barely need to.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On my desktop, I prefer building the whole tree &lt;a href=&quot;/2020/10/29/skipping-maven-mojos-properly.html&quot;&gt;as fast as possible without tests&lt;/a&gt;
and then running the individual tests for the area I am working on using &lt;code&gt;-Dtest=MyTest&lt;/code&gt; or &lt;code&gt;-Dit.test=MyIntegrationTest&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;On CI servers, I prefer using stock Maven with its default &lt;code&gt;singlethreaded&lt;/code&gt; builder to run all tests properly isolated.
To speed it up, it is often possible to split a large build into groups of modules which can be built and tested on separate worker nodes in parallel.
On those nodes I still use &lt;code&gt;singlethreaded&lt;/code&gt; builder so that the execution is serialized and reproducible.
That&amp;#8217;s quite easy to do in environments like GitHub actions.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Anyway if you conclude that (module-wise) parallel tests are a worthwhile goal, here is a couple of thoughts:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Starting helper services lazily (start only if it does not run already) may or may not solve the problem.
It depends on how your tests are written whether the situation morphes into the problem of shared mutable state I have described above.
Closing the resources after the tests may get tricky as well.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Redesigning your tests to use random ports might be a better strategy.
Using &lt;a href=&quot;https://www.testcontainers.org/features/networking/&quot;&gt;Testcontainers&lt;/a&gt; is a great way to do it for databases and other kinds of services are containerized or containerizable at least.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&amp;#160;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That&amp;#8217;s it for today.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Feel free to ping me on twitter (&lt;a href=&quot;https://twitter.com/ppalaga&quot;&gt;@ppalaga&lt;/a&gt; or &lt;a href=&quot;https://twitter.com/mvndaemon&quot;&gt;@mvndaemon&lt;/a&gt;)
or via &lt;a href=&quot;https://github.com/mvndaemon/mvnd/issues&quot;&gt;GitHub issues&lt;/a&gt; if you have more interesting issues related to parallel builds with &lt;code&gt;mvnd&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Stay tuned for the next &lt;code&gt;mvnd&lt;/code&gt; tip!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;a class=&quot;image&quot; href=&quot;https://twitter.com/mvndaemon&quot;&gt;&lt;img src=&quot;https://img.shields.io/twitter/url/https/twitter.com/mvndaemon.svg?style=social&amp;label=Follow%20%40mvndaemon&quot; alt=&quot;mvndaemon&quot;&gt;&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="mvnd" /><summary type="html">mvnd tip: Solving common issues of parallel builds In the previous mvnd tip, we have introduced mvnd's smart builder and explained how it works. Today, I&amp;#8217;d like discuss various issues you may hit when migrating from Maven singlethreaded builder and I&amp;#8217;ll propose some solutions.</summary></entry><entry><title type="html">mvnd tip: Parallel and non-parallel builds</title><link href="https://peter.palaga.org/2021/01/11/mvnd-parallel-builds.html" rel="alternate" type="text/html" title="mvnd tip: Parallel and non-parallel builds" /><published>2021-01-11T00:00:00+00:00</published><updated>2021-01-11T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/01/11/mvnd-parallel-builds</id><content type="html" xml:base="https://peter.palaga.org/2021/01/11/mvnd-parallel-builds.html">&lt;h1&gt;&lt;code&gt;mvnd&lt;/code&gt; tip: Parallel and non-parallel builds&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;/2021/01/08/mvnd-shortcuts.html&quot;&gt;Another&lt;/a&gt; tip that will serve as a base for the future
&lt;code&gt;&lt;a href=&quot;https://github.com/mvndaemon/mvnd&quot;&gt;mvnd&lt;/a&gt;&lt;/code&gt; documentation. Today about parallel and non-parallel builds.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;parallel_by_default&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#parallel_by_default&quot;&gt;&lt;/a&gt;Parallel by default&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you are building a multimodule source tree, whose internal dependencies allow for building some modules in parallel,
&lt;code&gt;mvnd&lt;/code&gt; will, by default, build them in parallel for you. The default number of threads is one or
&lt;code&gt;Runtime.getRuntime().availableProcessors() - 1&lt;/code&gt;, whichever is greater. You can change this value using
Maven&amp;#8217;s standard parameter &lt;code&gt;-T&lt;/code&gt;/&lt;code&gt;--threads&lt;/code&gt;. E.g. to use five threads the command would look like this:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ mvnd package -T5&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;How many threads should you use? Well, it depends on two factors at least:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;How many CPU cores are available on your machine? It typically does not bring any speedup to use more threads than
the number of threads your machine can run at the same time. Use &lt;code&gt;lscpu&lt;/code&gt; on Linux or its equivalent for your
operating system to figure out how many CPU cores you have available.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Which other tasks is your machine running? If you want to work inside your IDE or browser during the build, you
should leave one or two cores out of the set assigned to &lt;code&gt;mvnd&lt;/code&gt;. That&amp;#8217;s actually the assumption behind the default
value chosen by &lt;code&gt;mvnd&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;These are just general rules that may or may not hold for your situation. Feel free to experiment with various &lt;code&gt;-T&lt;/code&gt;
values and see which setting works best for you.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock tip&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;i class=&quot;fa icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;-T&lt;/code&gt;/&lt;code&gt;--threads&lt;/code&gt; allows for a &quot;processor count multiplier&quot; notation using &lt;code&gt;-T&amp;lt;n&amp;gt;C&lt;/code&gt; where &lt;code&gt;&amp;lt;n&amp;gt;&lt;/code&gt; is a (potentially
decimal) number to multiply the number of processors of the current machine. E.g. to use a half of the processors,
you&amp;#8217;d use &lt;code&gt;-T0.5C&lt;/code&gt;, to use twice as many threads as the number of processors, you&amp;#8217;d use &lt;code&gt;-T2C&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can persist your preference in &lt;code&gt;~/.m2/mvnd.properties&lt;/code&gt; as follows:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;properties&quot;&gt;mvnd.threads = 5
# or alternatively using the multiplier notation
# mvnd.threads = 0.5C&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;smart_builder_by_default&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#smart_builder_by_default&quot;&gt;&lt;/a&gt;&lt;code&gt;smart&lt;/code&gt; builder by default&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Maven has the concept of pluggable &lt;code&gt;builder&lt;/code&gt; since version 3.2.1.
It is &lt;a href=&quot;https://maven.apache.org/docs/3.2.1/release-notes#new-builder-interface-mng-5575&quot;&gt;described&lt;/a&gt; as a strategy for
scheduling and building projects. Stock Maven offers two builder implementations: &lt;code&gt;singlethreaded&lt;/code&gt; and &lt;code&gt;multithreaded&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Except for these two, at least one more can be found in the wild: the
&lt;a href=&quot;http://takari.io/book/30-team-maven.html#takari-smart-builder&quot;&gt;Takari Smart Builder&lt;/a&gt;. &lt;code&gt;mvnd&lt;/code&gt;'s &lt;code&gt;smart&lt;/code&gt; builder is
based on this one. It is actually a copy with a few minor modifications.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To characterize the Takari Smart Builder, let&amp;#8217;s cite from its &lt;a href=&quot;http://takari.io/book/30-team-maven.html#takari-smart-builder&quot;&gt;documentation&lt;/a&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;quoteblock&quot;&gt;
&lt;blockquote&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The primary difference between the standard multi-threaded scheduler in Maven and the Takari smart builder is illustrated below.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/01-11-mvnd-parallel-builds/smart-builder-scheduler.png&quot; alt=&quot;Standard and Smart Builder Scheduling&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The standard multi-threaded scheduler is using a rather naive and simple approach of using dependency-depth information in the project. It builds everything at a given dependency-depth before continuing to the next level.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The Takari Smart Builder is using a more advanced approach of dependency-path information. Projects are aggressively built along a dependency-path in topological order as upstream dependencies have been satisfied.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;smart&lt;/code&gt; builder is one of the features that make &lt;code&gt;mvnd&lt;/code&gt; so much faster from the standard Maven. (The other ones are
classloader caching in the Daemon and &lt;code&gt;mvnd&lt;/code&gt; command line client being a &lt;a href=&quot;https://www.graalvm.org/&quot;&gt;GraalVM&lt;/a&gt; native executable.)&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;mavens_serial_builder_via_1_serial&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#mavens_serial_builder_via_1_serial&quot;&gt;&lt;/a&gt;Maven&amp;#8217;s serial builder via &lt;code&gt;-1&lt;/code&gt;/&lt;code&gt;--serial&lt;/code&gt;&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can hit various issues when building with &lt;code&gt;smart&lt;/code&gt; builder, such as hidden dependencies between modules,
plugins relying on global mutable state, modules racing for system resources, etc. I am planning to dedicate my next
&lt;code&gt;mvnd&lt;/code&gt; tip to those issues and I&amp;#8217;d also like to sketch some possible solutions there. Before I do that that I can
offer only a very crude workaround if you encounter any issues with &lt;code&gt;smart&lt;/code&gt; builder: fallback to the stock Maven&amp;#8217;s
single-threaded builder by passing &lt;code&gt;-1&lt;/code&gt; or &lt;code&gt;--serial&lt;/code&gt; on the command line:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ mvnd package -1&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;or you can store your choice permanently in &lt;code&gt;~/.m2/mvnd.properties&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;properties&quot;&gt;mvnd.serial = true&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&amp;#160;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;That&amp;#8217;s it for today, stay tuned for the next &lt;code&gt;mvnd&lt;/code&gt; tip!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;a class=&quot;image&quot; href=&quot;https://twitter.com/mvndaemon&quot;&gt;&lt;img src=&quot;https://img.shields.io/twitter/url/https/twitter.com/mvndaemon.svg?style=social&amp;label=Follow%20%40mvndaemon&quot; alt=&quot;mvndaemon&quot;&gt;&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="mvnd" /><summary type="html">mvnd tip: Parallel and non-parallel builds Another tip that will serve as a base for the future mvnd documentation. Today about parallel and non-parallel builds.</summary></entry><entry><title type="html">mvnd tip: Shortcuts</title><link href="https://peter.palaga.org/2021/01/08/mvnd-shortcuts.html" rel="alternate" type="text/html" title="mvnd tip: Shortcuts" /><published>2021-01-08T00:00:00+00:00</published><updated>2021-01-08T00:00:00+00:00</updated><id>https://peter.palaga.org/2021/01/08/mvnd-shortcuts</id><content type="html" xml:base="https://peter.palaga.org/2021/01/08/mvnd-shortcuts.html">&lt;h1&gt;&lt;code&gt;mvnd&lt;/code&gt; tip: Shortcuts&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am starting to write these tips as a base for the future &lt;code&gt;&lt;a href=&quot;https://github.com/mvndaemon/mvnd&quot;&gt;mvnd&lt;/a&gt;&lt;/code&gt;
documentation. Today about keystrokes supported in the &lt;code&gt;mvnd&lt;/code&gt; client UI.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;to_revealhide_rolling_log_lines_for_the_individual_builder_threads&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#to_revealhide_rolling_log_lines_for_the_individual_builder_threads&quot;&gt;&lt;/a&gt;&lt;code&gt;+&lt;/code&gt;/&lt;code&gt;-&lt;/code&gt; to reveal/hide rolling log lines for the individual builder threads&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you are building a multimodule source tree, whose internal dependencies allow for building some modules in parallel,
&lt;code&gt;mvnd&lt;/code&gt; will by default choose the threaded view (as opposed to the rolling view known from the stock Maven). This
view will normally show a single status line for each builder thread containing the &lt;code&gt;artifactId&lt;/code&gt; of the module being
build along with the currently executed Maven mojo.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to see the rolling log messages for each thread, hit &lt;code&gt;+&lt;/code&gt; one or more times. Press &lt;code&gt;-&lt;/code&gt; to hide them again.
I am hitting three times &lt;code&gt;+&lt;/code&gt; and three times &lt;code&gt;-&lt;/code&gt; in this video:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/01-08-mvnd-shortcuts/mvnd-plus-minus.gif&quot; alt=&quot;Pressing three times plus and three times minus in a build with 5 threads&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock tip&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;i class=&quot;fa icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can pass your preferred rolling window size using &lt;code&gt;-Dmvnd.rollingWindowSize=3&lt;/code&gt; on the command line or you
can store it permanently in &lt;code&gt;~/.m2/mvnd.properties&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;properties&quot;&gt;mvnd.rollingWindowSize = 3&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;ctrlb_to_toggle_between_threaded_and_rolling_views&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#ctrlb_to_toggle_between_threaded_and_rolling_views&quot;&gt;&lt;/a&gt;&lt;code&gt;CTRL+B&lt;/code&gt; to toggle between threaded and rolling views&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you do not like the default threaded view for some reason, you can switch to the rolling view and back by hitting
&lt;code&gt;CTRL+B&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/images/2021/01-08-mvnd-shortcuts/mvnd-ctrl-b.gif&quot; alt=&quot;Toggling between threaded and rolling views via CTRL+B&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock tip&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;i class=&quot;fa icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You can pass &lt;code&gt;-Dmvnd.noBuffering&lt;/code&gt; on the command line to start with the rolling view or you can store your
preference permanently in &lt;code&gt;~/.m2/mvnd.properties&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;properties&quot;&gt;mvnd.noBuffering = true&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;a class=&quot;image&quot; href=&quot;https://twitter.com/mvndaemon&quot;&gt;&lt;img src=&quot;https://img.shields.io/twitter/url/https/twitter.com/mvndaemon.svg?style=social&amp;label=Follow%20%40mvndaemon&quot; alt=&quot;mvndaemon&quot;&gt;&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="mvnd" /><summary type="html">mvnd tip: Shortcuts I am starting to write these tips as a base for the future mvnd documentation. Today about keystrokes supported in the mvnd client UI.</summary></entry><entry><title type="html">When -DskipTests is not fast enough: skip Maven mojos properly</title><link href="https://peter.palaga.org/2020/10/29/skipping-maven-mojos-properly.html" rel="alternate" type="text/html" title="When -DskipTests is not fast enough: skip Maven mojos properly" /><published>2020-10-29T00:00:00+00:00</published><updated>2020-10-29T00:00:00+00:00</updated><id>https://peter.palaga.org/2020/10/29/skipping-maven-mojos-properly</id><content type="html" xml:base="https://peter.palaga.org/2020/10/29/skipping-maven-mojos-properly.html">&lt;h1&gt;When &lt;code&gt;-DskipTests&lt;/code&gt; is not fast enough: skip Maven mojos properly&lt;/h1&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;code&gt;-DskipTests&lt;/code&gt; is a well known way to skip the execution of unit tests during a Maven build and thus save time.
This is handy e.g. after pulling the changes from a team git repository which are supposed to have been tested by a CI
already.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This kind of skipping is not specific to &lt;code&gt;maven-surefire-plugin&lt;/code&gt;. Many other plugins have similar options:
Enforcer has &lt;code&gt;-Denforcer.skip&lt;/code&gt;, License Maven plugin has &lt;code&gt;-Dlicense.skip&lt;/code&gt;, etc. The more you want to
build quickly, without running needless mojos, the more you search for these skip parameters.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Some candidates for skipping, like unit tests and integration tests, are pretty obvious. Other may get revealed by
profiling your build either by using a stock Java profiler or by leveraging Maven specific tools like
&lt;a href=&quot;https://github.com/khmarbaise/maven-buildtime-profiler&quot;&gt;maven-buildtime-profiler&lt;/a&gt; or
&lt;a href=&quot;https://scans.gradle.com/#maven&quot;&gt;Gradle build scans for Maven&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At some point you are skipping every mojo execution that is not essential to your build. You create a dedicated
Maven profile listing all those skip flags, so that you do not need to remember and type them by hand.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But what if that&amp;#8217;s still not fast enough? Say that you work on a
&lt;a href=&quot;https://github.com/apache/camel-quarkus&quot;&gt;source tree that has 1200+ modules&lt;/a&gt; and&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;$ mvn clean install -DskipTests -Denforcer.skip -Dformatter.skip -Dimpsort.skip -Dquarkus.build.skip -Dgroovy.skip
...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  03:53 min&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;is not something you are happy about. How can this be made even faster?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Well, common sense (or further profiling with a Java profiler) may unveil that the named &lt;code&gt;skip*&lt;/code&gt; properties
do not prevent the skipped mojos' classes from being loaded, initialized, instantiated, configured and their
&lt;code&gt;execute()&lt;/code&gt; method from being invoked (that&amp;#8217;s where the &lt;code&gt;skip*&lt;/code&gt; parameters are actually being evaluated). That
might be quite a lot of superfluous CPU cycles and luckily, Maven offers a way how to avoid them.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The trick is to remove the skippable mojos from the Maven execution plan altogether. How can that be done? - the key
is in playing with the &lt;code&gt;&amp;lt;phase&amp;gt;&lt;/code&gt; to which the given mojo is bound. There are two ways how to reach that some mojo
is bound to no phase:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;By setting &lt;code&gt;&amp;lt;phase&amp;gt;none&amp;lt;/phase&amp;gt;&lt;/code&gt; or shortly &lt;code&gt;&amp;lt;phase/&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;By moving the given plugin definition from the the default profile-less &lt;code&gt;&amp;lt;build&amp;gt;&lt;/code&gt; section to a profile.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The option 1. needs to be used for mojos that Maven binds to some phase by default. E.g. the &lt;code&gt;test&lt;/code&gt; mojo of
&lt;code&gt;surefire-maven-plugin&lt;/code&gt; is bound to the &lt;code&gt;test&lt;/code&gt; phase by default. The option 2. may be used for all other mojos.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once we manage it to remove a mojo from the execution plan, its classes will neither be loaded, initialized,
instantiated, configured nor their &lt;code&gt;execute()&lt;/code&gt; methods will be called.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Let&amp;#8217;s have a look at an example. Say, that we want all the tests and source tree validation to happen in the default
&quot;profile-less&quot; build (&lt;code&gt;mvn verify&lt;/code&gt;) but we want them all to be skipped when building with the &lt;code&gt;-Dquickly&lt;/code&gt;
property.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To implement that, we need a profile. Surprisingly the profile is not going to exclude stuff when &lt;code&gt;-Dquickly&lt;/code&gt; is
present, it will rather include the stuff in the default &quot;profile-less&quot; build. To make &lt;code&gt;-Dquickly&lt;/code&gt; to work the way
we want, the profile will be enabled by default and disabled when &lt;code&gt;-Dquickly&lt;/code&gt; is present. This can be done using
Maven&amp;#8217;s &quot;negated&quot; property profile activation: &lt;code&gt;&amp;lt;property&amp;gt;&amp;lt;name&amp;gt;!quickly&amp;lt;/name&amp;gt;&amp;lt;/property&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is what it looks like for &lt;code&gt;surefire-maven-plugin&lt;/code&gt; and &lt;code&gt;maven-enforcer-plugin&lt;/code&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;build&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;plugins&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-surefire-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;tag&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;default-test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;phase&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- disable here but enable in the full profile --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;tag&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- We do not need to disable enforcer here, because --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Maven does not bind it to any phase by default --&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/plugins&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/build&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;profiles&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;profile&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Tests and sanity checks are disabled when building with '-Dquickly' --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;full&lt;span class=&quot;tag&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;activation&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;property&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;tag&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;!quickly&lt;span class=&quot;tag&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/activation&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;build&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;plugins&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-surefire-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;tag&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;tag&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;default-test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- assigned to a phase only if the full profile is active --&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;tag&quot;&gt;&amp;lt;phase&amp;gt;&lt;/span&gt;test&lt;span class=&quot;tag&quot;&gt;&amp;lt;/phase&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Enforcer is included in the execution plan only if --&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- the full profile is active --&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-enforcer-plugin&lt;span class=&quot;tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;tag&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;tag&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;my-enforcer-rules&lt;span class=&quot;tag&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;tag&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt;
                                &lt;span class=&quot;tag&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;enforce&lt;span class=&quot;tag&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt;
                            &lt;span class=&quot;tag&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
                                ...
                            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/plugins&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/build&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/profile&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/profiles&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;After &lt;a href=&quot;https://github.com/apache/camel-quarkus/pull/1962/files&quot;&gt;applying this trick&lt;/a&gt; to all non-essential mojos in
the source tree with 1200+ modules mentioned above, the quick build time goes down from 03:53 to 2:44:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;CodeRay highlight&quot;&gt;&lt;code data-lang=&quot;shell&quot;&gt;mvn clean install -Dquickly
...
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  02:44 min&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Who would expect such a big speedup?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;P.S.: You may want to try &lt;code&gt;&lt;a href=&quot;https://github.com/mvndaemon/mvnd&quot;&gt;mvnd&lt;/a&gt;&lt;/code&gt;, the Maven Daemon to reduce your build
times even further.&lt;/p&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">When -DskipTests is not fast enough: skip Maven mojos properly -DskipTests is a well known way to skip the execution of unit tests during a Maven build and thus save time. This is handy e.g. after pulling the changes from a team git repository which are supposed to have been tested by a CI already.</summary></entry><entry><title type="html">History of Camel Quarkus from the very beginning to 1.0.0</title><link href="https://peter.palaga.org/2020/08/11/camel-quarkus-early-history.html" rel="alternate" type="text/html" title="History of Camel Quarkus from the very beginning to 1.0.0" /><published>2020-08-11T00:00:00+00:00</published><updated>2020-08-11T00:00:00+00:00</updated><id>https://peter.palaga.org/2020/08/11/camel-quarkus-early-history</id><content type="html" xml:base="https://peter.palaga.org/2020/08/11/camel-quarkus-early-history.html">&lt;h1&gt;History of Camel Quarkus from the very beginning to 1.0.0&lt;/h1&gt;
&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I have originally written this for the upcoming Camel Quarkus 1.0.0 announcement, but then decided
to remove it from there based on some review comments. I still think the history deserves to be written somewhere, so
I am pasting it here.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;when_and_how_camel_quarkus_was_born&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#when_and_how_camel_quarkus_was_born&quot;&gt;&lt;/a&gt;When and how &lt;a href=&quot;https://github.com/apache/camel-quarkus&quot;&gt;Camel Quarkus&lt;/a&gt; was born?&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/lburgazzoli&quot;&gt;Luca&lt;/a&gt; and &lt;a href=&quot;https://github.com/gnodet&quot;&gt;Guillaume&lt;/a&gt; started porting Camel to
&lt;a href=&quot;https://github.com/quarkusio/quarkus&quot;&gt;Quarkus&lt;/a&gt; very early while Quarkus was still in the stealth mode at Red Hat.
The work started around November 2018 and was
&lt;a href=&quot;https://github.com/quarkusio/quarkus/commit/549c74d74f4ae6af83854e51f14db429adef7483&quot;&gt;merged to Quarkus master&lt;/a&gt; on Feb.
28, 2019 - shortly before Quarkus was
&lt;a href=&quot;https://developers.redhat.com/blog/2019/03/07/quarkus-next-generation-kubernetes-native-java-framework/&quot;&gt;publicly announced&lt;/a&gt;
on March 7, 2019. At that time, Quarkus
&lt;a href=&quot;https://github.com/quarkusio/quarkus/tree/0.11.0/extensions/camel&quot;&gt;supported just a handful of Camel components&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;moving_to_asf&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#moving_to_asf&quot;&gt;&lt;/a&gt;Moving to ASF&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The next important milestone was donating the Camel specific bits from the main Quarkus source tree to Apache Software
Foundation (ASF). This happened around July 2019 and the current
&lt;a href=&quot;https://github.com/apache/camel-quarkus&quot;&gt;GitHub home of the project&lt;/a&gt; is the result. Camel Quarkus thus became a
subproject of Apache Camel, along with &lt;a href=&quot;https://github.com/apache/camel-k&quot;&gt;Camel K&lt;/a&gt;,
&lt;a href=&quot;https://github.com/apache/camel-spring-boot&quot;&gt;Camel Spring Boot&lt;/a&gt;,
&lt;a href=&quot;https://github.com/apache/camel-karaf&quot;&gt;Camel Karaf&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/camel-kafka-connector&quot;&gt;Camel Kafka
Connector&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;the_life_under_asf&quot;&gt;&lt;a class=&quot;anchor&quot; href=&quot;#the_life_under_asf&quot;&gt;&lt;/a&gt;The life under ASF&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Under the new home, the project attracted a fair amount of new contributors (currently
&lt;a href=&quot;https://github.com/apache/camel-quarkus/graphs/contributors&quot;&gt;36 in total&lt;/a&gt;) which in turn brought a lot of
contributions.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Within those ~13 month from migrating to the ASF repo to 1.0.0 we released 7 milestones and 3 candidate releases.
That gives a rough average cadence of one release every ~5 weeks.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Stay tuned for Camel Quarkus 1.0.0!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">History of Camel Quarkus from the very beginning to 1.0.0 I have originally written this for the upcoming Camel Quarkus 1.0.0 announcement, but then decided to remove it from there based on some review comments. I still think the history deserves to be written somewhere, so I am pasting it here.</summary></entry></feed>