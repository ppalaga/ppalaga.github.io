<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Apache Camel K: ~1 sec. build and deploy on Kubernetes</title>

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/camel.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
    </head>
    <body>
        <div class="reveal">
            <div class="conf-banner">
                <img src="images/DevConf.cz-logo-white-vertical.svg" alt="DevConf.cz" style="position: absolute;bottom: 0;">
            </div>
            <div class="footer" style="display: none;">
                <img src="images/camel.svg" class="left"><a href="https://twitter.com/ppalaga">@ppalaga</a><img src="images/kube_logo_black_with_text.svg" class="right">
            </div>
            <div class="slides">
                <section>
                    <section>
                        <img data-src="images/camel-k.svg" alt="Apache Camel K" class="plain" style="width: 1 0em">
                        <h1>~1 sec. build and deploy<br>on Kubernetes</h1>
                        <p>&nbsp;</p>
                        <p>Peter Palaga</p>
                        <p>
                            <a href="https://twitter.com/ppalaga">@ppalaga</a>
                        </p>
                    </section>
                    <section>
                        <h2>Peter Palaga</h2>
                        <ul>
                            <li>Senior engineer at Red Hat Middleware
                                <ul>
                                    <li>Red Hat Fuse on EAP (WildFly Camel)</li>
                                    <li>JBoss EAP (WildFly)</li>
                                </ul>
                            </li>
                            <li>Author of
                                <ul>
                                    <li><a
                                        href="https://github.com/srcdeps/srcdeps">srcdeps</a>
                                        - source dependencies for Maven and Gradle</li>
                                    <li><a
                                        href="https://github.com/ec4j/editorconfig-maven-plugin">Maven</a>
                                        and <a
                                        href="https://github.com/ec4j/editorconfig-gradle-plugin">Gradle</a>
                                        plugins for <code>.editorconfig</code></li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <section>
                        <h2>Agenda</h2>
                        <ul>
                            <li>Apache Camel intro</li>
                            <li>Apache Camel K</li>
                        </ul>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>What is Apache Camel?</h2>
                        <a href="http://camel.apache.org/">http://camel.apache.org/</a>

                        <br><br>
                        Since 2007
                    </section>
                    <section>
                        Apache Camel is...
                        <h2>An integration library</h2>

                        <br>
                        <br>
                        <img alt="Systems integration" src="images/system1-system2.svg">

                    </section>
                    <section>
                        <small>Apache Camel is based on</small>
                        <h4>Enterprise Integration Patterns (EIP)</h4>
                        <img alt="EIPs" src="images/eips.svg">
                        <br>
                        <small><a href="https://www.enterpriseintegrationpatterns.com/">https://www.enterpriseintegrationpatterns.com/</a></small>
                    </section>
                    <section>
                        Apache Camel can...
                        <h2>integrate anything</h2>
                        <p>through its</p>
                        <h2>~280 components</h2>
                    </section>
                    <section>
                        <h3>Protocols, Filetypes, APIs, ...</h3>
                        <small style="font-size: 0.5em">ahc ahc-ws amqp apns as2 asn1 asterisk atmos atmosphere-websocket atom atomix avro aws
                            aws-xray azure bam barcode base64 beanio beanstalk bean-validator bindy blueprint bonita
                            boon box braintree cache caffeine cassandraql castor cdi chronicle chunk cmis cm-sms coap
                            cometd consul context corda core-osgi core-xml couchbase couchdb crypto crypto-cms csv cxf
                            cxf-transport digitalocean disruptor dns docker dozer drill dropbox eclipse ehcache ejb
                            elasticsearch elasticsearch5 elasticsearch-rest elsql etcd eventadmin exec facebook
                            fastjson fhir flatpack flink fop freemarker ftp ganglia geocoder git github google-bigquery
                            google-calendar google-drive google-mail google-pubsub google-sheets gora grape groovy
                            groovy-dsl grpc gson guava-eventbus guice hawtdb hazelcast hbase hdfs hdfs2 headersmap
                            hessian hipchat hl7 http http4 http-common hystrix ibatis ical iec60870 ignite infinispan
                            influxdb ipfs irc ironmq jackson jacksonxml jasypt javaspace jaxb jbpm jcache jclouds jcr
                            jdbc jetty jetty9 jetty-common jgroups jibx jing jira jms jmx johnzon jolt josql jpa jsch
                            jsonpath json-validator jt400 juel jxpath kafka kestrel krati kubernetes kura ldap ldif
                            leveldb linkedin lra lucene lumberjack lzf mail master metrics micrometer milo mina mina2
                            mllp mongodb mongodb3 mongodb-gridfs mqtt msv mustache mvel mybatis nagios nats netty
                            netty4 netty4-http netty-http nsq ognl olingo2 olingo4 openshift openstack opentracing
                            optaplanner paho paxlogging pdf pgevent printer protobuf pubnub quartz quartz2 quickfix
                            rabbitmq reactive-streams reactor restlet rest-swagger ribbon rmi routebox rss ruby rx
                            rxjava2 salesforce sap-netweaver saxon scala schematron scr script service servicenow
                            servlet servletlistener shiro sip sjms sjms2 slack smpp snakeyaml snmp soap solr spark
                            spark-rest splunk spring spring-batch spring-boot spring-cloud spring-cloud-consul
                            spring-cloud-netflix spring-cloud-zookeeper spring-integration spring-javaconfig
                            spring-ldap spring-redis spring-security spring-ws sql ssh stax stomp stream stringtemplate
                            swagger swagger-java syslog tagsoup tarfile telegram test test-blueprint test-cdi
                            testcontainers testcontainers-spring test-karaf testng test-spring thrift tika twilio
                            twitter undertow univocity-parsers urlrewrite velocity vertx weather web3j websocket
                            wordpress xchange xmlbeans xmljson xmlrpc xmlsecurity xmpp xstream yammer yql zendesk
                            zipfile zipkin zookeeper zookeeper-master
                        </small>
                    </section>
                    <section>
                        Routes defined via
                        <h3>Domain Specific Languages (DSL)</h3>
                        <table>
                            <tr>
                                <td style="border-bottom: none">Java</td>
                                <td style="border-bottom: none">XML</td>
                            </tr>
                            <tr>
                                <td><pre style="width: 100%; margin: 0px; font-size: 0.4em"><code class="hljs java">class MyCamelRouter extends RouteBuilder {
  @Override
  public void configure() throws Exception {
    from("twitter-search:"
        + "word1,word2")
      .log("Got a tweet: ${body}")
      .to("telegram:bots");
  }
}</code></pre></td>
                                <td><pre style="width: 100%; margin: 0px; font-size: 0.4em"><code class="hljs xml">&lt;routes
  xmlns="http://camel.apache.org/schema/spring">
  &lt;route id="my-route">
    &lt;from uri="twitter-search:word1,word2"/>
    &lt;log message="Got a tweet: ${body}"/>
    &lt;to uri="telegram:bots"/>
  &lt;/route>
&lt;/routes>

</code></pre></td>
                            </tr>
                        </table>
                        <p>Groovy, Scala, Kotlin, ...</p>
                    </section>
                    <section>
                        Apache Camel is...
                        <h2>Runnable on</h2>
                        <br>
                        <table>
                            <tr>
                                <td style="border-bottom: none; vertical-align: middle; padding: 0px; width: 350px"><img alt="Spring Boot" src="images/icon-spring-boot.svg" style="vertical-align: middle; width: 60px">&nbsp;Spring&nbsp;Boot</td>
                                <td style="border-bottom: none; vertical-align: middle; padding: 0px 20px 0px 0px"><img alt="Apache Karaf" src="images/karaf-logo.png" style="width: 350px;"></td>
                                <td style="border-bottom: none; vertical-align: middle; padding: 0px 0px 0px 25px"><img alt="WildFly" src="images/wildfly_logo.svg" style="width: 350px"></td>
                            </tr>
                        </table>
                        <br>
                        <p>Standalone</p>
                    </section>
                </section>
                <section>
                    <section>
                        <small>Apache Camel</small>
                        <h2>Demo</h2>
                        Twitter -> Telegram forwarding
                        <br>
                        <br>
                        <ul>
                            <li>Tweets containing <b>Camel</b> and <b>#devconfcz</b></li>
                            <li>Telegram bot: <b>camelDemoBot</b></li>
                        </ul>
                    </section>
                    <section>
                        <h2>Traditional way</h2>
                        of deploying Apache Camel on Kubernetes/OpenShift:
                        <ul>
                            <li><code>fabric8-maven-plugin</code> to build the image</li>
                            <li>1+ min to build and deploy a simple app</li>
                        </ul>
                    </section>
                </section>
                <section>
                    <section>
                        Apache Camel
                        <h2>New areas of interest</h2>
                        <ul>
                            <li class="fragment">Low code/no code integrations: <a href="https://syndesis.io/">Syndesis</a></li>
                            <li class="fragment">A "glue" for Serverless Functions</li>
                        </ul>
                        <br>
                        <br>
                        <div class="fragment">
                            <p>&#x2BA4; characterized by:</p>
                            <ul>
                                <li>Fast prototyping</li>
                                <li>Simple or no business logic</li>
                                <li>Low memory and CPU usage  esp. during startup</li>
                            </ul>
                        </div>
                        <aside class="notes">
                            Syndesis
                            <ul>
                                <li>Short demo if there is enough time</li>
                                <li>Connectors built from Camel components</li>
                                <li>Few clicks to define a integration</li>
                                <li>Graphical data mapping capabilities</li>
                            </ul>
                            Serverless
                            <ul>
                                <li>Camel K does not intend to replace any FaaS platform.</li>
                                <li>Camel K wants to integrate functions with other functions and external systems</li>
                            </ul>
                        </aside>

                    </section>
                </section>
                <section>
                    <section>
                        Welcome
                        <h2>Apache Camel K!</h2>

                        For fast development of simple routes
                        <br>
                        <br>
                        <p class="fragment">Subproject of Apache Camel<br>since Aug. 31st. 2018</p>
                    </section>
                    <section>
                        <h2>Camel K demo</h2>
                        <!-- Let's have a look what fast prototyping and simple routes mean here -->
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Camel K internals</h2>
                        <ul>
                            <li class="fragment"><code>kamel</code> client side binary
                                <ul>
                                    <li><a href="https://github.com/apache/camel-k/releases">github.com/apache/camel-k/releases</a></li>
                                </ul>
                            </li>
                            <li class="fragment">Camel K Operator</li>
                        </ul>
                    </section>
                    <section>
                        <h2>Kubernetes Operators</h2>
                        <ul>
                            <li>An Application Management concept</li>
                            <li>Does what a human operator would have to do
                                <ul>
                                    <li>Based on declarative input</li>
                                </ul>
                            </li>
                        </ul>
                        <br>
                        <br>
                        Since Kubernetes 1.7, <a href="https://coreos.com/operators">https://coreos.com/operators</a>

                    </section>
                    <section>
                        A Kubernetes Operator
                        <h2>How it works</h2>
                        <p class="fragment" style="text-align: left;">Via Kubernetes API:</p>
                        <ul>
                            <li class="fragment">Monitors the cluster</li>
                            <li class="fragment">Reacts:
                                <ul>
                                    <li>Add/remove/modify resources (pods/services/custom CRDs)</li>
                                    <li>Scale up/down</li>
                                    <li>Call endpoints of the running applications</li>
                                </ul>
                            </li>
                            <li class="fragment">Implements <b>custom logic</b></li>
                        </ul>
                    </section>
                    <section>
                        Kubernetes
                        <h2>Custom Resource Definitions (CRD)</h2>

                        <table>
                            <tr>
                                <td><b>Built-in</b> resources
                                    <ul>
                                        <li>pods, services, ...</li>
                                        <li><code>oc create</code>, <code>oc&nbsp;get</code>, <code>oc&nbsp;delete</code></li>
                                    </ul></td>
                                <td><b>CRDs</b>
                                    <ul>
                                        <li>Extend&nbsp;the&nbsp;cluster&nbsp;model</li>
                                        <li><code>oc create</code>, <code>oc get</code>, <code>oc delete</code></li>
                                        <li>Declarative input for operators</li>
                                    </ul></td>
                            </tr>
                        </table>
                    </section>

                    <section>
                        <h4>Camel K Operator</h4>

                        <img alt="Camel K internals" src="images/camel-k-internals.svg">

                        <aside class="notes">
                            <code>kamel</code> client creates an `integration` resource in the cluster
                            The operator is notified
                            * figures out how to deploy the `integartion`
                            * `Resolver` looks into the route definition
                            *
                            ** Either takes an available Image (buildless deploy)
                            ** Or builds a new image
                            * The route definition itself is not a part of the image
                            ** Mounted to the container as a ConfigMap

                            Same image for multiple routes that use the same set of components and deps
                            Route edits that do not change the set can be redeployed quickly
                            ~4 seconds for the simplest routes
                        </aside>
                    </section>
                    <section>
                        Apache Camel K
                        <h2>Image resolution (1/2)</h2>
                        <p style="text-align: left">Choose <code>IntegrationRuntime</code> based on DSL used</p>
                        <ul>
                            <li>Generic JVM (covers JavaScript)</li>
                            <li>Java
                                <div class="fragment" style="float: right">
                                    <table>
                                        <tr>
                                            <td style="font-weight: 100; font-size: 5em; padding: 0px 0px 0px 0.5em">}</td>
                                            <td style="vertical-align: middle;">Sets of <br>dependencies</div></td>
                                        </tr>
                                    </table>
                                </div></li>
                            <li>Groovy</li>
                            <li>Kotlin</li>
                            <li>Spring Boot</li>
                            <li>XML</li>
                        </ul>

                    </section>
                    <section>
                        Apache Camel K
                        <h2>Image resolution (2/2)</h2>
                        <ul>
                            <li>Based on the used Camel components
                                <ul>
                                    <li>Either takes an available Image (buildless deploy)</li>
                                    <li>Or builds a new image</li>
                                </ul>
                            </li>
                            <br>
                            <li class="fragment ">Route definition not a part of the image
                                <ul>
                                    <li>Either takes an available Image (buildless deploy)</li>
                                    <li>Mounted to the container as a ConfigMap</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <section>
                        <h2>Camel K limitations</h2>
                        <ul>
                            <li class="fragment">Not a 100% replacement for traditional Apache Camel</li>
                            <li class="fragment">No built in means for testing</li>
                        </ul>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Apache Camel K wrap up</h2>
                        <ul>
                            <li class="fragment">Operator based Kubernetes runtime for Camel</li>
                            <li class="fragment">Fast prototyping</li>
                            <li class="fragment">Routes with simple/no business logic</li>
                        </ul>
                    </section>
                    <section>
                        Apache Camel K
                        <h2>Project info</h2>
                        <ul>
                            <li>Apache License v2</li>
                            <li><a href="https://github.com/apache/camel-k">https://github.com/apache/camel-k</a></li>
                            <li>Chat: <a href="https://gitter.im/apache/camel-k">https://gitter.im/apache/camel-k</a></li>
                            <li>Mailing list: <a href="mailto:dev@camel.apache.org">dev@camel.apache.org</a></li>
                            <li>Follow <a href="https://twitter.com/ni_ferraro">@ni_ferraro</a> and <a href="https://twitter.com/lburgazzoli">@lburgazzoli</a></li>

                        </ul>
                        <br><br>
                        Feedback and contributions welcome!
                    </section>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info about config & dependencies:
            // - https://github.com/hakimel/reveal.js#configuration
            // - https://github.com/hakimel/reveal.js#dependencies
            Reveal.initialize({
                progress: true,
                history: true,
                controls: false,
                margin: 0.01,
                transition: 'slide', // none/fade/slide/convex/concave/zoom
                dependencies: [
                    { src: 'plugin/markdown/marked.js' },
                    { src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
            function adjustFooterAndConfBannerVisibility(event) {
                if (Reveal.isFirstSlide()) {
                    document.querySelector('.reveal .conf-banner').style.display = 'block';
                    document.querySelector('.reveal .footer').style.display = 'none';
                } else {
                    document.querySelector('.reveal .conf-banner').style.display = 'none';
                    document.querySelector('.reveal .footer').style.display = 'block';
                }
            }
            Reveal.addEventListener('slidechanged', adjustFooterAndConfBannerVisibility);
            Reveal.addEventListener('ready', adjustFooterAndConfBannerVisibility);
        </script>
    </body>
</html>
